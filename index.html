<!DOCTYPE HTML>
<html>
<head>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.7.2/mustache.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/0.20.0/math.min.js" type="text/javascript"></script>
</head>
<body>
  A<select id="A">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
    <option>7</option>
    <option>8</option>
    <option>9</option>
  </select>
  B<select id="B">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
    <option>7</option>
    <option>8</option>
    <option>9</option>
  </select>
  C<select id="C">
    <option>correct</option>
    <option>incorrect</option>
  </select>
  D<select id="D">
    <option>no</option>
    <option>at least one</option>
  </select>
  <br/>
  <h3>Enter equations in <a href="https://github.com/josdejong/mathjs/blob/master/docs/expressions.md#syntax" targer="_blank">Math.js syntax</a></h3>
  <input class="equation" type="text" value="{{A}} > {{B}}" size="50" />
  <input class="equation" type="text" value="{{A}} ^ {{B}} > 7" size="50" />
  <input class="equation" type="text" value="({{A}} * {{B}}) / ({{A}} + {{B}})" size="50" />
  <br/>
  <div id="equationErrors"></div>
  <h3>Equivalent values will appear here</h3>
  <input class="output" type="text" size="50" />
  <input class="output" type="text" size="50" />
  <input class="output" type="text" size="50" />
  <br/>
  <input id="validate" type="button" value="check"/>

  <script type="text/javascript">
    $(document).ready(function() {

      // create an instance of math.js
      var math = mathjs();
      $("#validate").on( "click", function() {

        // lightweight error checking for Mustache syntax
        function sloppyMustache(equationNode) {
          var nodeValue = equationNode.value;
          var left = nodeValue.match(/{{/g);
          var right = nodeValue.match(/}}/g);
          if (left.length != right.length) {
            return false;
          } else {
            return true;
          };
        };
        // dynamically build an object based on the ID and value of the dropdowns
        // to be passed to Mustache for variable replacement
        var selects = {};
        $('select').each( function( index, element ){
          var variable = this.id;
          var value = $(this).find(":selected").text();
          eval("selects." + variable + " = '" + value + "'");
        });

        // map the input boxes for the equations to their equivalent outputs
        // first render the mustache templates then eval with math.js
        var eq = $(".equation");
        $(".output").each( function( index, element ){
          if (sloppyMustache(eq[index]) ) {
            element.value = math.eval(Mustache.render(eq[index].value, selects));
          } else {
            $("#equationErrors").innerText = "hello";
            console.log ( $("#equationErrors").innerText );
            $("#equationErrors").append( eq[index].value + " contains mismatched braces" + "<br/>" );
          }
        });

      });

    });
  </script>
</body>
</html>